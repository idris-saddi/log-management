<configuration>

    <!-- Console fallback appender -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <!-- GELF TCP Appender for Graylog -->
    <appender name="GELF-TCP" class="de.siegmar.logbackgelf.GelfTcpAppender">
        <graylogHost>graylog</graylogHost> <!-- Docker service name -->
        <port>12201</port>
        <connectTimeout>3000</connectTimeout>
        <reconnectDelay>2000</reconnectDelay>
        <queueSize>512</queueSize>

        <encoder class="de.siegmar.logbackgelf.GelfEncoder">
            <facility>log-service</facility> <!-- Tag logs with your service name -->
            <includeLoggerName>true</includeLoggerName>
            <includeThreadName>true</includeThreadName>
            <includeMdcData>true</includeMdcData> <!-- Important for structured fields -->
            <includeExceptionCause>true</includeExceptionCause>
        </encoder>
    </appender>

    <!-- Root logger with both appenders -->
    <root level="INFO">
        <appender-ref ref="STDOUT" />
        <appender-ref ref="GELF-TCP" />
    </root>

</configuration>
